<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/home/pelle/rbt-verification/src/RedBlackTree.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='syntax.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-comment'>{-# OPTIONS_GHC -fplugin=LiquidHaskell #-}</span></a>
<span class=hs-linenum> 2: </span>
<span class=hs-linenum> 3: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>RedBlackTree</span> <span class='hs-layout'>(</span><span class='hs-varid'>isMember</span><span class='hs-layout'>,</span> <span class='hs-varid'>okasakiInsert</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 4: </span>
<span class=hs-linenum> 5: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Color</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Red</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Black</span>
<span class=hs-linenum> 6: </span>
<span class=hs-linenum> 7: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>RBTree</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Node</span> <span class='hs-conid'>Color</span> <span class='hs-layout'>(</span><span class='hs-conid'>RBTree</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>RBTree</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 8: </span>
<span class=hs-linenum> 9: </span><span class='hs-definition'>isMember</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>RBTree</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>10: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
a -&gt; (RedBlackTree.RBTree a) -&gt; GHC.Types.Bool</span><span class='hs-definition'>isMember</span></a> <span class='hs-keyword'>_</span> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a>
<span class=hs-linenum>11: </span><span class='hs-definition'>isMember</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>left</span> <span class='hs-varid'>val</span> <span class='hs-varid'>right</span><span class='hs-layout'>)</span>
<span class=hs-linenum>12: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == val##a16Xc}</span><span class='hs-varid'>val</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
a -&gt; (RedBlackTree.RBTree a) -&gt; GHC.Types.Bool</span><span class='hs-varid'>isMember</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : (RedBlackTree.RBTree a) | v == left##a16Xb}</span><span class='hs-varid'>left</span></a>
<span class=hs-linenum>13: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == val##a16Xc}</span><span class='hs-varid'>val</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v
                      &amp;&amp; v == True}</span><span class='hs-conid'>True</span></a>
<span class=hs-linenum>14: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == val##a16Xc}</span><span class='hs-varid'>val</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
a -&gt; (RedBlackTree.RBTree a) -&gt; GHC.Types.Bool</span><span class='hs-varid'>isMember</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : (RedBlackTree.RBTree a) | v == right##a16Xd}</span><span class='hs-varid'>right</span></a>
<span class=hs-linenum>15: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a>
<span class=hs-linenum>16: </span>
<span class=hs-linenum>17: </span><span class='hs-definition'>okasakiInsert</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>RBTree</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>RBTree</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>18: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
a -&gt; (RedBlackTree.RBTree a) -&gt; (RedBlackTree.RBTree a)</span><span class='hs-definition'>okasakiInsert</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(RedBlackTree.RBTree a)</span><span class='hs-varid'>tree</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      (RedBlackTree.RBTree a) -&gt; (RedBlackTree.RBTree a) | VV == makeBlack##a16Xh}</span><span class='hs-varid'>makeBlack</span></a> <a class=annot href="#"><span class=annottext>(RedBlackTree.RBTree a)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>ins</span> <a class=annot href="#"><span class=annottext>{v : (RedBlackTree.RBTree a) | v == tree##a16Xf}</span><span class='hs-varid'>tree</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>19: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>20: </span>    <a class=annot href="#"><span class=annottext>(RedBlackTree.RBTree a) -&gt; (RedBlackTree.RBTree a)</span><span class='hs-varid'>ins</span></a> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(RedBlackTree.RBTree a)</span><span class='hs-conid'>Node</span></a> <a class=annot href="#"><span class=annottext>{v : RedBlackTree.Color | v == Red}</span><span class='hs-conid'>Red</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a . (RedBlackTree.RBTree a) | VV == Leaf}</span><span class='hs-conid'>Leaf</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x##a16Xe}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a . (RedBlackTree.RBTree a) | VV == Leaf}</span><span class='hs-conid'>Leaf</span></a>
<span class=hs-linenum>21: </span>    <span class='hs-varid'>ins</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>color</span> <span class='hs-varid'>left</span> <span class='hs-varid'>val</span> <span class='hs-varid'>right</span><span class='hs-layout'>)</span>
<span class=hs-linenum>22: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x##a16Xe}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == val##a16Xk}</span><span class='hs-varid'>val</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      RedBlackTree.Color -&gt; (RedBlackTree.RBTree a) -&gt; a -&gt; (RedBlackTree.RBTree a) -&gt; (RedBlackTree.RBTree a) | VV == balance}</span><span class='hs-varid'>balance</span></a> <a class=annot href="#"><span class=annottext>{v : RedBlackTree.Color | v == color##a16Xi}</span><span class='hs-varid'>color</span></a> <a class=annot href="#"><span class=annottext>(RedBlackTree.RBTree a)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>ins</span> <a class=annot href="#"><span class=annottext>{v : (RedBlackTree.RBTree a) | v == left##a16Xj}</span><span class='hs-varid'>left</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == val##a16Xk}</span><span class='hs-varid'>val</span></a> <a class=annot href="#"><span class=annottext>{v : (RedBlackTree.RBTree a) | v == right##a16Xl}</span><span class='hs-varid'>right</span></a>
<span class=hs-linenum>23: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x##a16Xe}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == val##a16Xk}</span><span class='hs-varid'>val</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      RedBlackTree.Color -&gt; (RedBlackTree.RBTree a) -&gt; a -&gt; (RedBlackTree.RBTree a) -&gt; (RedBlackTree.RBTree a) | VV == Node}</span><span class='hs-conid'>Node</span></a> <a class=annot href="#"><span class=annottext>{v : RedBlackTree.Color | v == color##a16Xi}</span><span class='hs-varid'>color</span></a> <a class=annot href="#"><span class=annottext>{v : (RedBlackTree.RBTree a) | v == left##a16Xj}</span><span class='hs-varid'>left</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == val##a16Xk}</span><span class='hs-varid'>val</span></a> <a class=annot href="#"><span class=annottext>{v : (RedBlackTree.RBTree a) | v == right##a16Xl}</span><span class='hs-varid'>right</span></a>
<span class=hs-linenum>24: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x##a16Xe}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == val##a16Xk}</span><span class='hs-varid'>val</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      RedBlackTree.Color -&gt; (RedBlackTree.RBTree a) -&gt; a -&gt; (RedBlackTree.RBTree a) -&gt; (RedBlackTree.RBTree a) | VV == balance}</span><span class='hs-varid'>balance</span></a> <a class=annot href="#"><span class=annottext>{v : RedBlackTree.Color | v == color##a16Xi}</span><span class='hs-varid'>color</span></a> <a class=annot href="#"><span class=annottext>{v : (RedBlackTree.RBTree a) | v == left##a16Xj}</span><span class='hs-varid'>left</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == val##a16Xk}</span><span class='hs-varid'>val</span></a> <a class=annot href="#"><span class=annottext>(RedBlackTree.RBTree a)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>ins</span> <a class=annot href="#"><span class=annottext>{v : (RedBlackTree.RBTree a) | v == right##a16Xl}</span><span class='hs-varid'>right</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>25: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Classes.IP [GHC.Types.Char] GHC.Internal.Stack.Types.CallStack) | v == $dIP_a171q}</span><span class='hs-varid'>error</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"unexpected pattern"</span></a>
<span class=hs-linenum>26: </span>    <span class=hs-error><a class=annot href="#"><span class=annottext>forall a . (RedBlackTree.RBTree a) -&gt; (RedBlackTree.RBTree a)</span><span class='hs-varid'>makeBlack</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-layout'>(</span></span><span class=hs-error><span class='hs-conid'>Node</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-keyword'>_</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-varid'>left</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-varid'>val</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-varid'>right</span></span><span class=hs-error><span class='hs-layout'>)</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-keyglyph'>=</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{VV : forall a .
      RedBlackTree.Color -&gt; (RedBlackTree.RBTree a) -&gt; a -&gt; (RedBlackTree.RBTree a) -&gt; (RedBlackTree.RBTree a) | VV == Node}</span><span class='hs-conid'>Node</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : RedBlackTree.Color | v == Black}</span><span class='hs-conid'>Black</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : (RedBlackTree.RBTree a) | v == left##a16Xm}</span><span class='hs-varid'>left</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{VV : a | VV == val##a16Xn}</span><span class='hs-varid'>val</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : (RedBlackTree.RBTree a) | v == right##a16Xo}</span><span class='hs-varid'>right</span></a></span>
<span class=hs-linenum>27: </span>	<span class='hs-varid'>makeBlack</span> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Leaf</span>
<span class=hs-linenum>28: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a .
RedBlackTree.Color -&gt; (RedBlackTree.RBTree a) -&gt; a -&gt; (RedBlackTree.RBTree a) -&gt; (RedBlackTree.RBTree a)</span>
</a></span><span class=hs-linenum>29: </span><span class='hs-definition'>balance</span> <span class='hs-conid'>Black</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-conid'>Red</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-conid'>Red</span> <span class='hs-varid'>node1</span> <span class='hs-varid'>val1</span> <span class='hs-varid'>node2</span><span class='hs-layout'>)</span> <span class='hs-varid'>val2</span> <span class='hs-varid'>node3</span><span class='hs-layout'>)</span> <span class='hs-varid'>val3</span> <span class='hs-varid'>node4</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Node</span> <span class='hs-conid'>Red</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-conid'>Black</span> <span class='hs-varid'>node1</span> <span class='hs-varid'>val1</span> <span class='hs-varid'>node2</span><span class='hs-layout'>)</span> <span class='hs-varid'>val2</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-conid'>Black</span> <span class='hs-varid'>node3</span> <span class='hs-varid'>val3</span> <span class='hs-varid'>node4</span><span class='hs-layout'>)</span>
</pre>
</body>
</html>